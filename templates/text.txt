{% extends 'base.html' %}

{% block content %}
  <div class="container">
    <div class="row">
      {% comment %} <div class="d-flex justify-content-center bg-primary text-darck text-center border rounded shadow-sm fw-bold"></div> {% endcomment %}
      <div class="col-md-12 mb-4">
        <div class="card shadow-sm fw-bold">
          <div class="card-header text-light bg-primary fs-3 text-center">
            {% if search_date %}
              Rapport du {{ search_date }}
            {% else %}
              Rapport
            {% endif %}
          </div>
          <div class="card-body table-responsive">
            <table class="table table-bordered border-black table-hover table-sm text-center align-middle custom-table">
              <thead>
                <tr>
                  <th colspan="17" class="bg-warning-subtle text-dark fs-3 text-capitalize">indicateur de Production</th>
                </tr>
                <tr>
                  <th rowspan="2" colspan="3" class="text-dark fw-bolder bg-info-subtle">Atelier</th>
                  <th rowspan="2" class="text-dark fw-bolder bg-success-subtle">Objectif par post</th>
                  <th colspan="3" class="text-dark text-uppercase fw-bolder bg-warning-subtle">post a</th>
                  <th colspan="3" class="text-dark text-uppercase fw-bolder bg-warning-subtle">post b</th>
                  <th colspan="3" class="text-dark text-uppercase fw-bolder bg-warning-subtle">post c</th>
                  <th colspan="4" class="text-dark fst-italic fw-bolder bg-orange-100">Daily Production</th>
                </tr>
                <tr>
                  {% comment %}Post A{% endcomment %}
                  <th class="text-dark fw-bolder bg-info-subtle">Réalisé shift A</th>
                  <th class="text-dark fw-bolder bg-info-subtle">Heure de marche</th>
                  <th class="text-dark fw-bolder bg-info-subtle">Productivité</th>
                  {% comment %}Post B{% endcomment %}
                  <th class="text-dark fw-bolder bg-info-subtle">Réalisé shift A</th>
                  <th class="text-dark fw-bolder bg-info-subtle">Heure de marche</th>
                  <th class="text-dark fw-bolder bg-info-subtle">Productivité</th>
                  {% comment %}Post C{% endcomment %}
                  <th class="text-dark fw-bolder bg-info-subtle">Réalisé shift A</th>
                  <th class="text-dark fw-bolder bg-info-subtle">Heure de marche</th>
                  <th class="text-dark fw-bolder bg-info-subtle">Productivité</th>
                  {% comment %}Daily Production{% endcomment %}
                  <th class="text-dark text-capitalize fst-italic fw-bolder bg-success-subtle">daily target</th>
                  <th class="text-dark text-capitalize fst-italic fw-bolder bg-info-subtle">totaly per day</th>
                  <th class="text-dark text-capitalize fst-italic fw-bolder bg-info-subtle">hrs de marche</th>
                  <th class="text-dark text-capitalize fst-italic fw-bolder bg-info-subtle">Productivité</th>
                </tr>
              </thead>
              <tbody>
                <tr style="" class="text-dark">
                  <td colspan="3" class="text-dark fw-bolder h5 bg-info-subtle heith">Ciment Mill</td>
                  <td class="text-dark fw-bolder fs-6 bg-success-subtle">206</td>
                  {% comment %}Post A{% endcomment %}
                  {% if object_broy_post_06h %}
                    {% for object in object_broy %}
                      {% if object.post.post == '06H-14H' %}
                        <td class="text-dark bg-light fw-bolder fs-6">
                          {% if object.prod %}
                            {{ object.prod }}
                          {% endif %}
                        </td>
                        <td class="text-dark bg-info-subtle fw-bolder fs-6">
                          {% if object.temp_march %}
                            {{ object.temp_march }}
                          {% endif %}
                        </td>
                        <td class="text-dark bg-info-subtle fw-bolder fs-6">
                          {% if object.rend %}
                            {{ object.rend }}
                          {% endif %}
                        </td>
                      {% endif %}
                    {% endfor %}
                  {% else %}
                    <td class="text-dark fw-bolder fs-6 bg-light"></td>
                    <td class="text-dark fw-bolder fs-6 bg-info-subtle"></td>
                    <td class="text-dark fw-bolder fs-6 bg-info-subtle"></td>
                  {% endif %}

                  {% comment %}Post B{% endcomment %}

                  {% if object_broy_post_14h %}
                    {% for object in object_broy %}
                      {% if object.post.post == '14H-22H' %}
                        <td class="text-dark fw-bolder fs-6 bg-light">
                          {% if object.prod %}
                            {{ object.prod }}
                          {% endif %}
                        </td>
                        <td class="text-dark fw-bolder fs-6 bg-info-subtle">
                          {% if object.temp_march %}
                            {{ object.temp_march }}
                          {% endif %}
                        </td>
                        <td class="text-dark fw-bolder fs-6 bg-info-subtle">
                          {% if object.rend %}
                            {{ object.rend }}
                          {% endif %}
                        </td>
                      {% endif %}
                    {% endfor %}
                  {% else %}
                    <td class="text-dark fw-bolder fs-6 bg-light"></td>
                    <td class="text-dark fw-bolder fs-6 bg-info-subtle"></td>
                    <td class="text-dark fw-bolder fs-6 bg-info-subtle"></td>
                  {% endif %}

                  {% comment %}Post C{% endcomment %}
                  {% if object_broy_post_22h %}
                    {% for object in object_broy %}
                      {% if object.post.post == '22H-06H' %}
                        <td class="text-dark fw-bolder fs-6 bg-light">
                          {% if object.prod %}
                            {{ object.prod }}
                          {% endif %}
                        </td>
                        <td class="text-dark fw-bolder fs-6 bg-info-subtle">
                          {% if object.temp_march %}
                            {{ object.temp_march }}
                          {% endif %}
                        </td>
                        <td class="text-dark fw-bolder fs-6 bg-info-subtle">
                          {% if object.rend %}
                            {{ object.rend }}
                          {% endif %}
                        </td>
                      {% endif %}
                    {% endfor %}
                  {% else %}
                    <td class="text-dark fw-bolder fs-6 bg-light"></td>
                    <td class="text-dark fw-bolder fs-6 bg-info-subtle"></td>
                    <td class="text-dark fw-bolder fs-6 bg-info-subtle"></td>
                  {% endif %}

                  <td class="text-dark bg-success-subtle"></td>
                  <td class="text-dark fw-bolder fs-6 bg-orange-100">
                    {% if total_prod %}
                      {{ total_prod }}
                    {% endif %}
                  </td>
                  <td class="text-dark fw-bolder fs-6 bg-orange-100">
                    {% if total_temp_march_b %}
                      {{ total_temp_march_b }}
                    {% endif %}
                  </td>
                  <td class="text-dark fw-bolder fs-6 bg-orange-100">
                    {% if total_rend_b %}
                      {{ total_rend_b }}
                    {% endif %}
                  </td>
                </tr>
                <tr>
                  <th class="text-dark fw-bolder bg-info-subtle wdth" colspan="2" rowspan="2">Ciment Mill</th>
                  <th class="text-dark fw-bolder bg-info-subtle" colspan="1">Consommation Energétique(MWh)</th>
                  <td class="text-dark fw-bolder bg-success-subtle">6.18</td>

                  <td class="text-dark bg-light" colspan="3">30.7</td>
                  <td class="text-dark bg-light" colspan="3">30.7</td>
                  <td class="text-dark bg-light" colspan="3">30.7</td>
                  <td class="text-dark bg-success-subtle" colspan="0">30.7</td>
                  <td class="text-dark bg-orange-100" colspan="3">30.7</td>
                </tr>
                <tr>
                  <th class="text-dark fw-bolder bg-info-subtle" colspan="1">SPC(KWh/T)</th>

                  <td class="text-dark fw-bolder bg-success-subtle">30</td>
                  {% if object_broy_post_06h %}
                    {% for object in object_broy %}
                      {% if object.post.post == '06H-14H' %}
                        <td class="text-dark bg-info-subtle fw-bolder fs-6" colspan="3">
                          {% if object.conso %}
                            {{ object.conso }}
                          {% endif %}
                        </td>
                      {% endif %}
                    {% endfor %}
                  {% else %}
                    <td class="text-dark bg-info-subtle fw-bolder fs-6" colspan="3"></td>
                  {% endif %}

                  {% if object_broy_post_14h %}
                    {% for object in object_broy %}
                      {% if object.post.post == '14H-22H' %}
                        <td class="text-dark bg-info-subtle fw-bolder fs-6" colspan="3">
                          {% if object.conso %}
                            {{ object.conso }}
                          {% endif %}
                        </td>
                      {% endif %}
                    {% endfor %}
                  {% else %}
                    <td class="text-dark bg-info-subtle fw-bolder fs-6" colspan="3"></td>
                  {% endif %}

                  {% if object_broy_post_22h %}
                    {% for object in object_broy %}
                      {% if object.post.post == '22H-06H' %}
                        <td class="text-dark bg-info-subtle fw-bolder fs-6" colspan="3">
                          {% if object.conso %}
                            {{ object.conso }}
                          {% endif %}
                        </td>
                      {% endif %}
                    {% endfor %}
                  {% else %}
                    <td class="text-dark bg-info-subtle fw-bolder fs-6" colspan="3"></td>
                  {% endif %}

                  <td class="text-dark fw-bolder bg-success-subtle">18,54</td>
                  <td class="text-dark fw-bolder fs-6 bg-orange-100" colspan="3">
                    {% if total_conso %}
                      {{ total_conso }}
                    {% endif %}
                  </td>
                </tr>
                {% comment %}Partie packing{% endcomment %}
                <tr>
                  <th class="text-dark fw-bolder text-capitalize bg-info-subtle" rowspan="4" colspan="2">cement dispach</th>
                  <th class="text-dark fw-bolder bg-info-subtle" colspan="1">Livraison(tonnes)</th>
                  <td class="text-dark fw-bolder bg-success-subtle">30</td>
                  {% comment %}Partie livraison et vrack{% endcomment %}

                  {% if object_post_06h %}
                    {% for object in object_pack %}
                      {% if object.post.post == '06H-14H' %}
                        <td class="text-dark bg-light fw-bolder fs-6">
                          {% if object.livraison %}
                            {{ object.livraison }}
                          {% endif %}
                        </td>
                        <td class="text-dark bg-light fw-bolder fs-6">
                          {% if object.vrack %}
                            {{ object.vrack }}
                          {% endif %}
                        </td>
                        <td class="text-dark bg-light fw-bolder fs-6">
                          {% if object.som_liv_vrack %}
                            {{ object.som_liv_vrack }}
                          {% endif %}
                        </td>
                      {% endif %}
                    {% endfor %}
                  {% else %}
                    <td class="text-dark bg-light"></td>
                    <td class="text-dark bg-light"></td>
                    <td class="text-dark bg-light"></td>
                  {% endif %}

                  {% if object_post_14h %}
                    {% for object in object_pack %}
                      {% if object.post.post == '14H-22H' %}
                        <td class="text-dark bg-light fw-bolder fs-6">
                          {% if object.livraison %}
                            {{ object.livraison }}
                          {% endif %}
                        </td>
                        <td class="text-dark bg-light fw-bolder fs-6">
                          {% if object.vrack %}
                            {{ object.vrack }}
                          {% endif %}
                        </td>
                        <td class="text-dark bg-light fw-bolder fs-6">
                          {% if object.som_liv_vrack %}
                            {{ object.som_liv_vrack }}
                          {% endif %}
                        </td>
                      {% endif %}
                    {% endfor %}
                  {% else %}
                    <td class="text-dark bg-light"></td>
                    <td class="text-dark bg-light"></td>
                    <td class="text-dark bg-light"></td>
                  {% endif %}

                  {% if object_post_22h %}
                    {% for object in object_pack %}
                      {% if object.post.post == '22H-06H' %}
                        <td class="text-dark bg-light fw-bolder fs-6">
                          {% if object.livraison %}
                            {{ object.livraison }}
                          {% endif %}
                        </td>
                        <td class="text-dark bg-light fw-bolder fs-6">
                          {% if object.vrack %}
                            {{ object.vrack }}
                          {% endif %}
                        </td>
                        <td class="text-dark bg-light fw-bolder fs-6">
                          {% if object.som_liv_vrack %}
                            {{ object.som_liv_vrack }}
                          {% endif %}
                        </td>
                      {% endif %}
                    {% endfor %}
                  {% else %}
                    <td class="text-dark bg-light"></td>
                    <td class="text-dark bg-light"></td>
                    <td class="text-dark bg-light"></td>
                  {% endif %}

                  <td class="text-dark fw-bolder bg-success-subtle">618</td>
                  <td class="text-dark fw-bolder fs-6 bg-orange-100">
                    {% if total_liv %}
                      {{ total_liv }}
                    {% endif %}
                  </td>
                  <td class="text-dark fw-bolder fs-6 bg-orange-100">
                    {% if total_vrack %}
                      {{ total_vrack }}
                    {% endif %}
                  </td>
                  <td class="text-dark fw-bolder fs-6 bg-orange-100">
                    {% if toat_som_liv_vrack %}
                      {{ toat_som_liv_vrack }}
                    {% endif %}
                  </td>
                </tr>
                {% comment %}Partie des sacs ensachés{% endcomment %}
                <tr>
                  <th class="text-dark fw-bolder bg-info-subtle" colspan="1">Nombre de sacs livrés</th>
                  <th class="text-dark fw-bolder bg-success-subtle">4142</th>

                  {% if object_post_06h %}
                    {% for object in object_pack %}
                      {% if object.post.post == '06H-14H' %}
                        <td colspan="3" class="text-dark bg-light fw-bolder fs-6">
                          {% if object.ens %}
                            {{ object.ens }}
                          {% endif %}
                        </td>
                      {% endif %}
                    {% endfor %}
                  {% else %}
                    <td colspan="3" class="text-dark bg-light"></td>
                  {% endif %}

                  {% if object_post_14h %}
                    {% for object in object_pack %}
                      {% if object.post.post == '14H-22H' %}
                        <td colspan="3" class="text-dark bg-light fw-bolder fs-6">
                          {% if object.ens %}
                            {{ object.ens }}
                          {% endif %}
                        </td>
                      {% endif %}
                    {% endfor %}
                  {% else %}
                    <td colspan="3" class="text-dark bg-light"></td>
                  {% endif %}

                  {% if object_post_22h %}
                    {% for object in object_pack %}
                      {% if object.post.post == '22H-06H' %}
                        <td colspan="3" class="text-dark bg-light fw-bolder fs-6">
                          {% if object.ens %}
                            {{ object.ens }}
                          {% endif %}
                        </td>
                      {% endif %}
                    {% endfor %}
                  {% else %}
                    <td colspan="3" class="text-dark bg-light"></td>
                  {% endif %}

                  <th class="text-dark fw-bolder bg-success-subtle">12336</th>
                  <td class="text-dark fs-6 fw-bolder bg-orange-100" colspan="3">
                    {% if total_ens %}
                      {{ total_ens }}
                    {% endif %}
                  </td>
                </tr>
                {% comment %}Partie casse{% endcomment %}
                <tr>
                  <th class="text-dark fw-bolder bg-info-subtle" colspan="1">Nombre de sacs cassés</th>
                  <th class="text-dark fw-bolder bg-success-subtle">12</th>

                  {% if object_post_06h %}
                    {% for object in object_pack %}
                      {% if object.post.post == '06H-14H' %}
                        <td colspan="3" class="text-dark bg-light fw-bolder fs-6">
                          {% if object.casse %}
                            {{ object.casse }}
                          {% endif %}
                        </td>
                      {% endif %}
                    {% endfor %}
                  {% else %}
                    <td colspan="3" class="text-dark bg-light"></td>
                  {% endif %}

                  {% if object_post_14h %}
                    {% for object in object_pack %}
                      {% if object.post.post == '14H-22H' %}
                        <td colspan="3" class="text-dark bg-light fw-bolder fs-6">
                          {% if object.casse %}
                            {{ object.casse }}
                          {% endif %}
                        </td>
                      {% endif %}
                    {% endfor %}
                  {% else %}
                    <td colspan="3" class="text-dark bg-light"></td>
                  {% endif %}

                  {% if object_post_22h %}
                    {% for object in object_pack %}
                      {% if object.post.post == '22H-06H' %}
                        <td colspan="3" class="text-dark bg-light fw-bolder fs-6">
                          {% if object.casse %}
                            {{ object.casse }}
                          {% endif %}
                        </td>
                      {% endif %}
                    {% endfor %}
                  {% else %}
                    <td colspan="3" class="text-dark bg-light"></td>
                  {% endif %}

                  <th class="text-dark fw-bolder bg-success-subtle">37</th>
                  <td class="text-dark fw-bolder fs-6 bg-orange-100" colspan="3">
                    {% if total_cas %}
                      {{ total_cas }}
                    {% endif %}
                  </td>
                </tr>
                {% comment %}Partie taux de casse{% endcomment %}
                <tr>
                  <th class="text-dark fw-bolder bg-info-subtle" colspan="1">Taux de casse</th>
                  <th class="text-dark fw-bolder bg-success-subtle">0.30%</th>
                  {% if object_post_06h %}
                    {% for object in object_pack %}
                      {% if object.post.post == '06H-14H' %}
                        <td colspan="3" class="text-dark fw-bolder fs-6 bg-info-subtle">
                          {% if object.tx_cas %}
                            {{ object.tx_cas }}
                          {% endif %}
                        </td>
                      {% endif %}
                    {% endfor %}
                  {% else %}
                    <td colspan="3" class="text-dark bg-info-subtle"></td>
                  {% endif %}

                  {% if object_post_14h %}
                    {% for object in object_pack %}
                      {% if object.post.post == '14H-22H' %}
                        <td colspan="3" class="text-dark fw-bolder fs-6 bg-info-subtle">
                          {% if object.tx_cas %}
                            {{ object.tx_cas }}
                          {% endif %}
                        </td>
                      {% endif %}
                    {% endfor %}
                  {% else %}
                    <td colspan="3" class="text-dark bg-info-subtle"></td>
                  {% endif %}

                  {% if object_post_22h %}
                    {% for object in object_pack %}
                      {% if object.post.post == '22H-06H' %}
                        <td colspan="3" class="text-dark fw-bolder fs-6 bg-info-subtle">
                          {% if object.tx_cas %}
                            {{ object.tx_cas }}
                          {% endif %}
                        </td>
                      {% endif %}
                    {% endfor %}
                  {% else %}
                    <td colspan="3" class="text-dark bg-info-subtle"></td>
                  {% endif %}

                  <th class="text-dark fw-bolder bg-success-subtle">0.30%</th>
                  <td class="text-dark fw-bolder fs-6 bg-orange-100" colspan="3">
                    {% if total_tx_cas %}
                      {{ total_tx_cas }}
                    {% endif %}
                  </td>
                </tr>
                {% comment %}Partie Rendement et Temps de marche{% endcomment %}
                <tr>
                  <th colspan="2" class="text-dark fw-bolder bg-info-subtle">Temps de marche</th>
                  <th colspan="1" class="text-dark fw-bolder bg-info-subtle">Rendement de livraison(T/H)</th>
                  <th class="text-dark fw-bolder bg-success-subtle">45</th>

                  {% if object_post_06h %}
                    {% for object in object_pack %}
                      {% if object.post.post == '06H-14H' %}
                        <td class="text-dark fw-bolder fs-6 bg-info-subtle" colspan="2">
                          {% if object.temp_march %}
                            {{ object.temp_march }}
                          {% endif %}
                        </td>
                        <td class="text-dark fw-bolder fs-6 bg-info-subtle" colspan="1">
                          {% if object.rend %}
                            {{ object.rend }}
                          {% endif %}
                        </td>
                      {% endif %}
                    {% endfor %}
                  {% else %}
                    <td class="text-dark fw-bolder fs-6 bg-info-subtle" colspan="2"></td>
                    <td class="text-dark fw-bolder fs-6 bg-info-subtle" colspan="1"></td>
                  {% endif %}

                  {% if object_post_14h %}
                    {% for object in object_pack %}
                      {% if object.post.post == '14H-22H' %}
                        <td class="text-dark fw-bolder fs-6 bg-info-subtle" colspan="2">
                          {% if object.temp_march %}
                            {{ object.temp_march }}
                          {% endif %}
                        </td>
                        <td class="text-dark fw-bolder fs-6 bg-info-subtle" colspan="1">
                          {% if object.rend %}
                            {{ object.rend }}
                          {% endif %}
                        </td>
                      {% endif %}
                    {% endfor %}
                  {% else %}
                    <td class="text-dark fw-bolder fs-6 bg-info-subtle" colspan="2"></td>
                    <td class="text-dark fw-bolder fs-6 bg-info-subtle" colspan="1"></td>
                  {% endif %}

                  {% if object_post_22h %}
                    {% for object in object_pack %}
                      {% if object.post.post == '22H-06H' %}
                        <td class="text-dark fw-bolder fs-6 bg-info-subtle" colspan="2">
                          {% if object.temp_march %}
                            {{ object.temp_march }}
                          {% endif %}
                        </td>
                        <td class="text-dark fw-bolder fs-6 bg-info-subtle" colspan="1">
                          {% if object.rend %}
                            {{ object.rend }}
                          {% endif %}
                        </td>
                      {% endif %}
                    {% endfor %}
                  {% else %}
                    <td class="text-dark fw-bolder fs-6 bg-info-subtle" colspan="2"></td>
                    <td class="text-dark fw-bolder fs-6 bg-info-subtle" colspan="1"></td>
                  {% endif %}
                  <td class="text-dark fw-bolder bg-success-subtle"></td>
                  <td class="text-dark fw-bolder fs-6 bg-orange-100" colspan="2">
                    {% if total_temp_march %}
                      {{ total_temp_march }}
                    {% endif %}
                  </td>
                  <td class="text-dark fw-bolder fs-6 bg-orange-100" colspan="1">
                    {% if total_rend %}
                      {{ total_rend }}
                    {% endif %}
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-md-12">
        <div class="card shadow-sm fw-bold">
          {% comment %} <div class="card-header text-center fs-3 bg-danger">Rapport du {{ search_date }}</div> {% endcomment %}
          <div class="card-body table-responsive">
            <table class="table table-bordered border-black table-hover table-sm text-center align-middle custom-table">
              <thead></thead>
              <tbody>
                {% comment %}la partie des arrêt de broyage{% endcomment %}
                <tr>
                  <th class="bg-info-subtle text-dark fs-3" colspan="8">Arrêt du Broyage</th>
                </tr>
                <tr>
                  <th class="bg-info-subtle fs-5 fw-bold text-dark">Shift</th>
                  <th class="bg-info-subtle fs-5 fw-bold text-dark">Dédut Arrêt</th>
                  <th class="bg-info-subtle fs-5 fw-bold text-dark">Fin Arrêt</th>
                  <th class="bg-info-subtle fs-5 fw-bold text-dark" colspan="2">Durée</th>
                  <th class="bg-info-subtle fs-5 fw-bold text-dark">DEPT</th>
                  <th class="bg-info-subtle fs-5 fw-bold text-dark">Descrition Arrêt</th>
                  <th class="bg-info-subtle fs-5 fw-bold text-dark">Solutions Apportées</th>
                </tr>
                {% for object in object_panne %}
                  <tr>
                    <td class="text-dark bg-violet fw-bold fs-5">{{ object.broyage.post }}</td>
                    <td class="text-dark bg-light fw-bold fs-6">{{ object.start_panne }}</td>
                    <td class="text-dark bg-light fw-bold fs-6">{{ object.end_panne }}</td>
                    <td class="text-dark bg-violet fw-bold fs-6">{{ object.duree_formatee }}</td>
                    <td class="text-dark bg-light fw-bold fs-6">{{ object.temp_arret }}</td>
                    <td class="text-dark bg-light fw-bold fs-6">{{ object.departement }}</td>
                    <td class="text-dark bg-light fw-bold fs-6">{{ object.description }}</td>
                    <td class="text-dark bg-light fw-bold fs-6">{{ object.solution }}</td>
                  </tr>
                {% empty %}
                  <tr>
                    <td colspan="9" class="fst-italic text-muted">Aucune panne enregistrée pour cette journée.</td>
                  </tr>
                {% endfor %}

                {% comment %}la partie des arrêt de broyage{% endcomment %}
                <tr>
                  <th class="bg-info-subtle text-dark fs-3" colspan="8">Arrêt du Dispach</th>
                </tr>
                <tr>
                  <th class="bg-info-subtle fs-5 fw-bold text-dark">Shift</th>
                  <th class="bg-info-subtle fs-5 fw-bold text-dark">Dédut Arrêt</th>
                  <th class="bg-info-subtle fs-5 fw-bold text-dark">Fin Arrêt</th>
                  <th class="bg-info-subtle fs-5 fw-bold text-dark" colspan="2">Durée</th>
                  <th class="bg-info-subtle fs-5 fw-bold text-dark">DEPT</th>
                  <th class="bg-info-subtle fs-5 fw-bold text-dark">Descrition Arrêt</th>
                  <th class="bg-info-subtle fs-5 fw-bold text-dark">Solutions Apportées</th>
                </tr>
                {% for object in object_pann %}
                  <tr>
                    <td class="text-dark bg-violet fw-bold fs-5">{{ object.packing.post }}</td>
                    <td class="text-dark bg-light fw-bold fs-6">{{ object.start_panne }}</td>
                    <td class="text-dark bg-light fw-bold fs-6">{{ object.end_panne }}</td>
                    <td class="text-dark bg-violet fw-bold fs-6">{{ object.duree_formatee }}</td>
                    <td class="text-dark bg-light fw-bold fs-6">{{ object.temp_arret }}</td>
                    <td class="text-dark bg-light fw-bold fs-6">{{ object.departement }}</td>
                    <td class="text-dark bg-light fw-bold fs-6">{{ object.description }}</td>
                    <td class="text-dark bg-light fw-bold fs-6">{{ object.solution }}</td>
                  </tr>
                {% empty %}
                  <tr>
                    <td colspan="9" class="fst-italic text-muted">Aucune panne enregistrée pour cette journée.</td>
                  </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Styles personnalisés -->
  <style>
    /* Couleurs adoucies (pastels neutres) */
    .bg-orange-100 { background-color: #f8e7d4 !important; } /* doux */
    .bg-success-subtle { background-color: #e6f7ea !important; }
    .bg-info-subtle { background-color: #eef6ff !important; }
    .bg-warning-subtle { background-color: #fff9e6 !important; }
    .bg-violet { background-color: #d6ccf9 !important; color: #1b1b1b !important; }

    /* Bordures claires et nettes pour toutes les cellules (style type "excel") */
    .custom-table th, .custom-table td {
      border: 1px solid #c8cfd6 !important;
      padding: 0.55rem !important;
      vertical-align: middle !important;
      color: #1f2937 !important;
      background-clip: padding-box;
    }

    /* Conserver styles existants plus doux */
    .heith { height: 160px !important; }
    .wdth { width: 30px !important; }
    table th, table td {
      vertical-align: middle !important;
      padding: 0.55rem !important;
    }

    /* En-tête carte */
    .card-header { border-bottom: 1px solid rgba(0,0,0,0.06); }

    /* Sticky header léger (si scroll) */
    thead th { position: sticky; top: 0; z-index: 2; backdrop-filter: blur(2px); }

    /* Ajustements mobile */
    @media (max-width: 768px) {
      .heith { height: auto !important; }
      table { font-size: 0.88rem; }
    }
  </style>
{% endblock %}
